#* @vtlvariable name="om" type="org.nrg.xdat.om.XnatSubjectdata" *#
<!-- BEGIN /templates/screens/xnat_subjectData/actionsBox/ViewInOHIFViewer.vm -->
<!-- allowGuest: true -->
<!-- Sequence: 6 -->
<li class="yuimenuitem">
    <a id="ohifViewer" href="#"><div class="ic">&nbsp;</div><div class="ic_spacer">&nbsp;</div>View Subject</a>
</li>

<script>
    $('#ohifViewer').click(function (e) {
      openSubjectView(e);
    });

    function openSubjectView() {
      var dataContext = XNAT.data.context;

      var projectId = dataContext.projectID;
      var subjectId = dataContext.subjectID;
      var parentProjectId = dataContext.parentProjectID;

      var rootUrlWithPort = XNAT.url.getProtocol() + '//' + XNAT.url.getDomain() + ":" + XNAT.url.getPort() + XNAT.url.rootUrl('').replace(/\/+$/, "");

      var params = '?subjectId=' + subjectId + '&projectId=' + projectId;

      if (parentProjectId) {
        params = params + '&parentProjectId=' + parentProjectId;
      }

      window.location.href = rootUrlWithPort + '/VIEWER' + params;

      //window.open(rootUrlWithPort + '/VIEWER' + params);
    }
</script>
